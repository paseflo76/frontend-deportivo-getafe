(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const r of c.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function t(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(n){if(n.ep)return;n.ep=!0;const c=t(n);fetch(n.href,c)}})();const p=(e=!0)=>{const o="global-loader";let t=document.getElementById(o);e?t||(t=document.createElement("div"),t.id=o,t.innerHTML='<img src="/assets/balon7.gif" alt="" />',document.body.appendChild(t)):t==null||t.remove()},g=async(e,o="GET",t=null,a=null)=>{const n=t instanceof FormData,c={};a&&(c.Authorization=`Bearer ${a}`),n||(c["Content-Type"]="application/json");const r={method:o,headers:c,body:n?t:t?JSON.stringify(t):null};try{const s=await fetch(e,r),d=(s.headers.get("Content-Type")||"").includes("application/json")?await s.json():null;if(!s.ok)throw{status:s.status,body:d};return d}catch(s){throw s}};//! funcion componente button
const y=(e,o,t,a)=>{const n=document.createElement("button");return n.classList="main-button",n.classList.add(t),n.classList.add(a),n.textContent=o,e.append(n),n},w=async()=>{const e=document.querySelector("main");if(!document.querySelector("body"))return console.error("body no encontrado");e.innerHTML="";const t=document.createElement("div");t.id="admin-panel";const a=await H(),n=document.createElement("div");n.id="lista-eventos",t.append(a,n),e.append(t),p(!0),await S(n),p(!1)},N=async()=>{const e=localStorage.getItem("token");try{return await g("http://localhost:3000/api/v2/eventos/tipos","GET",null,e)}catch(o){return console.error(o),[]}},H=async()=>{const e=document.createElement("form"),o=document.createElement("input"),t=document.createElement("input"),a=document.createElement("input"),n=document.createElement("select"),c=document.createElement("input");o.placeholder="Título",t.placeholder="Fecha",a.placeholder="Lugar",c.type="file",c.accept="image/*",(await N()).forEach(i=>{const l=document.createElement("option");l.value=i,l.textContent=i,n.appendChild(l)});const s=y(e,"Crear Evento","secundary","s");return e.append(o,t,a,n,c,s),e.addEventListener("submit",async i=>{i.preventDefault();const l=new FormData;l.append("titulo",o.value),l.append("fecha",t.value),l.append("lugar",a.value),l.append("tipo",n.value),l.append("img",c.files[0]),p(!0);try{const d=localStorage.getItem("token");await g("http://localhost:3000/api/v2/eventos","POST",l,d),await w()}catch(d){console.error(d)}finally{p(!1)}}),e},S=async e=>{e.innerHTML="";const o=localStorage.getItem("token");try{const t=await g("http://localhost:3000/api/v2/eventos","GET",null,o);for(const a of t){const n=document.createElement("div");n.className="admin-evento";const c=document.createElement("h3"),r=document.createElement("img"),s=document.createElement("p"),i=document.createElement("p"),l=document.createElement("p");c.textContent=a.titulo,r.src=a.img,s.textContent=a.fecha,i.textContent=a.lugar,l.textContent=a.tipo;const d=y(n,"Editar","secundary","s");d.addEventListener("click",()=>{document.querySelector(".modal-edicion")||I(a)});const m=y(n,"Borrar","secundary","s");m.addEventListener("click",async()=>{p(!0),await g(`http://localhost:3000/api/v2/eventos/${a._id}`,"DELETE",null,o),await S(e),p(!1)}),n.append(c,s,r,i,l,d,m),e.append(n)}}catch(t){console.error(t)}},I=async e=>{const o=document.createElement("div"),t=document.createElement("form"),a=document.createElement("input"),n=document.createElement("input"),c=document.createElement("input"),r=document.createElement("input"),s=document.createElement("img"),i=document.createElement("select");o.className="modal-edicion",a.value=e.titulo,a.placeholder="Título",n.value=e.fecha,n.placeholder="Fecha",c.value=e.lugar,c.placeholder="Lugar",r.type="file",s.src=e.img,(await N()).forEach(h=>{const v=document.createElement("option");v.value=h,v.textContent=h,h===e.tipo&&(v.selected=!0),i.appendChild(v)});const d=document.createElement("button");d.textContent="Guardar",d.type="submit";const m=document.createElement("button");m.textContent="Cerrar",m.type="button",m.addEventListener("click",()=>o.remove()),t.append(a,n,c,s,r,i,d,m),o.appendChild(t),document.getElementById("lista-eventos").appendChild(o),t.addEventListener("submit",async h=>{h.preventDefault();const v=localStorage.getItem("token");if(r.files.length>0){const E=r.files[0],u=new FormData;u.append("img",E),u.append("titulo",a.value),u.append("fecha",n.value),u.append("lugar",c.value),u.append("tipo",i.value);try{await fetch(`http://localhost:3000/api/v2/eventos/${e._id}`,{method:"PUT",headers:{Authorization:`Bearer ${v}`},body:u}),o.remove(),await w()}catch(L){console.error(L)}}else{const E={titulo:a.value,fecha:n.value,lugar:c.value,img:e.img,tipo:i.value};try{await fetch(`http://localhost:3000/api/v2/eventos/${e._id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`},body:JSON.stringify(E)}),o.remove(),C("Admin")}catch(u){console.error(u)}}})};//! funcion mostrar cardEvento
const M=async()=>{const e=document.querySelector("main");e.innerHTML="",p(!0);const o=await g("http://localhost:3000/api/v2/eventos");p(!1),F(o,e)},F=(e,o)=>{o.innerHTML="";for(const t of e){const a=document.createElement("div");a.id="Eventos";const n=document.createElement("div");n.className="evento";const c=document.createElement("p"),r=document.createElement("img"),s=document.createElement("h2"),i=document.createElement("p"),l=document.createElement("p"),d=y(n,"Confirmar asistencia","secundary","s");c.textContent=t.tipo,r.src=t.img,s.textContent=t.titulo,i.textContent=t.fecha,l.textContent=t.lugar,d.addEventListener("click",()=>{if(n.querySelector(".asist-list"))return;const f=document.createElement("div");f.className="asist-list";const h=document.createElement("div");h.className="asist-options";const v=document.createElement("div");v.className="asistentes";const E=y(h,"cerrar","secundary","s");E.addEventListener("click",()=>f.remove()),f.append(h,v,E),n.appendChild(f),O(t._id,f)}),n.append(c,r,s,i,l,d),a.appendChild(n),o.appendChild(a)}},O=(e,o)=>{const t=o.querySelector(".asist-list");t&&t.remove();const a=document.createElement("div");a.className="asist-list";const n=document.createElement("div");n.className="asist-options";const c=document.createElement("div");c.className="asistentes",a.append(n,c),o.appendChild(a),["Va a entrenar 👍","En duda ❓","No puede ❌"].forEach(s=>{const i=y(n,s,"secundary","s");i.addEventListener("click",async()=>{await P(e,s),await x(e,a)}),n.appendChild(i)}),x(e,a)},P=async(e,o)=>{const t=localStorage.getItem("token");await g(`http://localhost:3000/api/v2/eventos/${e}/asistencia`,"PATCH",{estado:o},t)},x=async(e,o)=>{const a=(await g("http://localhost:3000/api/v2/eventos")).find(r=>r._id===e),n=o.querySelector(".asistentes");n.innerHTML="";const c={"Va a entrenar 👍":[],"En duda ❓":[],"No puede ❌":[]};a.asistentes.forEach(r=>{var i;const s=((i=r.user)==null?void 0:i.userName)||"Usuario";c[r.estado]&&c[r.estado].push(s)});for(const r in c){const s=document.createElement("div");s.className="options";const i=document.createElement("h4");i.textContent=r,s.appendChild(i);const l=document.createElement("ul");l.className="ulAsist",c[r].forEach(d=>{const m=document.createElement("li");m.textContent=d,l.appendChild(m)}),s.appendChild(l),n.appendChild(s)}},k=async()=>{document.querySelector("main"),p(!0),await M(),p(!1)};//!
const q=()=>{const e=document.querySelector("main");e.innerHTML="";const o=document.createElement("div");o.id="login",B(o),e.append(o)},b=(e,o)=>{let t=e.querySelector(".pError");t||(t=document.createElement("p"),t.classList.add("pError"),e.append(t)),t.textContent=o,setTimeout(()=>t.remove(),3e3)},B=e=>{const o=document.createElement("form"),t=document.createElement("p"),a=document.createElement("input"),n=document.createElement("input"),c=document.createElement("input"),r=document.createElement("button");c.type="password",a.placeholder="User Name",n.placeholder="Email",c.placeholder="******",r.textContent="Login";let s=!0;t.textContent="¿No tienes cuenta? Regístrate aquí.",t.addEventListener("click",()=>{s=!s,r.textContent=s?"Login":"Register",t.textContent=s?"¿No tienes cuenta? Regístrate aquí.":"¿Ya tienes cuenta? Inicia sesión aquí."}),e.append(o),o.append(t,a,n,c,r),o.addEventListener("submit",i=>{i.preventDefault(),D(a.value,n.value,c.value,o,s)})},D=async(e,o,t,a,n)=>{var s;if(!e||!o||!t){b(a,"Por favor completa todos los campos.");return}const c={userName:e,email:o,password:t},r=n?"http://localhost:3000/api/v2/users/Login":"http://localhost:3000/api/v2/users/Register";p(!0);try{const i=await g(r,"POST",c);localStorage.setItem("token",i.token),await C("home"),T()}catch(i){if(i.status===400){const l=((s=i.body)==null?void 0:s.message)||"Error";if(n)b(a,"Usuario o Contraseña Incorrectos");else{if(l==="User already exists")return D(e,o,t,a,!0);b(a,l)}}else b(a,"Error de red o servidor.")}finally{p(!1)}},$=e=>{if(!e)return null;try{return JSON.parse(atob(e.split(".")[1]))}catch{return null}},T=()=>{const e=document.querySelector("header");if(!e)return;e.innerHTML="";const o=document.createElement("div");o.className="divContainer";const t=document.createElement("div");t.className="nav-Header";const a=document.createElement("nav");a.className="nav hidden";const n=document.createElement("div");n.className="iconDepor";const c=document.createElement("img");c.src="assets/deportivo.png",c.alt="Logo",n.appendChild(c);const r=document.createElement("div");r.className="menu-icon";const s=document.createElement("img");s.src="assets/menu.png",s.alt="Menu",r.appendChild(s);const i=document.createElement("div");i.className="decoration";const l=document.createElement("img"),d=document.createElement("img"),m=document.createElement("img");l.src="assets/potero.png",d.src="assets/jugador-de-futbol1.png",d.alt="jugador futbol",m.src="assets/jugador-de-futbol2.png",m.alt="jugador futbol2",l.src="assets/portero.png",l.alt="portero",i.appendChild(d),i.appendChild(m),i.appendChild(l);const f=localStorage.getItem("token"),h=$(f),v=[{texto:"Home",path:"home",function:k},{texto:"Editar",path:"admin",function:w},{texto:"Login",path:"login",function:q}];(h==null?void 0:h.rol)!=="Admin"&&v.splice(1,1);for(const E of v){const u=document.createElement("a");E.texto==="Login"&&f?(u.textContent="Logout",u.href="#home",u.addEventListener("click",L=>{L.preventDefault(),localStorage.removeItem("token"),T(),C("home")})):(u.textContent=E.texto,u.href=`#${E.path}`,u.addEventListener("click",L=>{L.preventDefault(),C(E.path)})),a.append(u)}r.addEventListener("click",()=>{a.classList.toggle("show")}),t.appendChild(r),t.appendChild(a),o.appendChild(n),o.appendChild(i),o.appendChild(t),e.appendChild(o)},A=()=>{const e=document.querySelector("footer");if(!e)return;e.innerHTML="";const o=document.createElement("div"),t=document.createElement("p");t.textContent="© Copyright 2025 - Deportivo Getafe - Pablo Serrano",o.appendChild(t),e.appendChild(o)},j={home:k,login:q,admin:w},C=async e=>{var t;(t=document.querySelectorAll(".modal-edicion"))==null||t.forEach(a=>a.remove());const o=j[e];o&&(p(!0),await o(),location.hash=`#${e}`,T(),A(),p(!1))},J=()=>{const e=document.querySelector("#app");e.innerHTML=`
    <header></header>
    <main></main>
    <footer></footer>
  `,T(),A()};window.addEventListener("load",async()=>{J();const e=location.hash.replace("#","")||"home";await C(e)});window.addEventListener("hashchange",async()=>{const e=location.hash.replace("#","");await C(e)});
